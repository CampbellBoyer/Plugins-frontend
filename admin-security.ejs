<!DOCTYPE html>
<html>
<head>
  <title>Admin Settings</title>
  <%- include('header'); %>
</head>
<body>
<div id="app">
  <%- include('top-navigation'); %>
  <!-- Admin Tabs -->
  <div class="link-tab uk-margin-left uk-margin-right">
    <h4>
      <a href="/admin-database" class="uk-padding-small">Alumni</a>&nbsp;&nbsp;&nbsp;
      <a href="/admin-group" class="uk-padding-small">Groups</a>&nbsp;&nbsp;&nbsp;
      <a href="/admin-event" class="uk-padding-small">Events</a>&nbsp;&nbsp;&nbsp;
      <a href="/admin-news" class="uk-padding-small">News</a>&nbsp;&nbsp;&nbsp;
      <a class="tab-active uk-padding-small">Security</a>&nbsp;&nbsp;&nbsp;
      <a href="/admin-settings" class="uk-padding-small">Settings</a>
    </h4>
    <hr class="border-slate"></hr>
  </div>

  <!--------------------------->
  <!-- ROLES/PERMISSIONS -->
  <!--------------------------->
  <div class="uk-card uk-card-default uk-margin-medium-top uk-margin-right uk-margin-left">
    <div class="uk-card-header container-top">
        <div class="uk-grid-small uk-flex-middle" uk-grid>
          <h4 class="norwester font-white">Permissions <h5 class="font-white" id="user_count">(4)</h5></h4>
        </div>
    </div>
    <div class="charcoal uk-padding-small">
      <form class="uk-width-1-1">
        <div class="uk-form-controls uk-inline uk-width-1-3@m uk-margin-right">
          <span class="uk-form-icon" uk-icon="icon: search"></span>
            <input class="uk-input border-charcoal2" type="text" placeholder="Search permissions">
        </div>
        <div class="uk-inline uk-width-1-3@m uk-margin-right">
          <select class="uk-select border-charcoal2">
            <option>Sort Alphabetically (A-Z)</option>
            <option>Sort Alphabetically (Z-A)</option>
          </select>
        </div>
        <div class="uk-inline uk-float-right">
          <h5 class="font-white"><a href="#" class="font-white">Clear Filters</a> &nbsp;|&nbsp; <a href="#add_perm" class="font-white" uk-toggle>+ Add</a></h5>
        </div>
      </form>
    </div>

    <div class="uk-card-body white uk-padding-remove uk-margin-remove uk-overflow-auto">
      <div class="uk-grid uk-padding-remove" uk-grid>
        <div class="uk-width-1-3">
          <table class="uk-table uk-table-small alumni-table uk-margin-remove">
            <tbody>
              <tr class="selected"><td>Class Agent<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></span></td></tr>
              <tr><td>Group Leader<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td>Paid Members<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td>Free Members<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td>Admin<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td><span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></span></td></tr>
              <tr><td><span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td><span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td><span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
              <tr><td><span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right"></td></tr>
            </tbody>
          </table>
          <div class="black">
            <ul class="uk-pagination uk-margin-remove uk-flex-center uk-padding-small">
              <li><a href="#"><span uk-icon="icon: chevron-left; ratio: 2" class="font-white"></span></a></li>
              <li>
                <div>
                  <select class="uk-select border-charcoal2">
                      <option>1</option>
                  </select>
                </div>
              </li>
              <li class="font-white uk-margin-small">of 1</li>
              <li><a href="#"><span uk-icon="icon: chevron-right; ratio: 2" class="font-white"></span></a></li>
            </ul>
          </div>
        </div>

        <div class="uk-padding uk-width-1-3">
          <h4 class="tight norwester">Roles</h4>
          <h6>Roles dictate what a user can view and do in the system:</h6>
          <label><input class="uk-checkbox" type="checkbox" checked> &nbsp; View Admin Menu</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; View Dashboard</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; View List (Manage)</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; Add Entry</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; Add Entry Moderated</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; Edit Entry</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; Edit Entry Moderated</label><br>
          <label><input class="uk-checkbox" type="checkbox"> &nbsp; Delete Entry</label><br>
        </div>
        <div class="uk-padding uk-width-1-3 uk-margin-large-top">
          <div class="uk-margin-large"></div>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; View Public Entries</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; View Private Entries</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; Send group emails</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; Download group lists</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; Send one on one emails</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; Edit own profile</label><br>
            <label><input class="uk-checkbox" type="checkbox"> &nbsp; Enter events on calendar</label><br>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Permission Modal -->
  <div id="add_perm" uk-modal>
    <div class="uk-modal-dialog">
      <button class="uk-modal-close-default" type="button" uk-close></button>
      <div class="uk-modal-header fog">
        <h3 class="uk-modal-title norwester">Create a Permission</h3>
      </div>

      <div class="uk-modal-body fog uk-padding">
        <label class="uk-form-label" for="form-stacked-text">Give the Permission a Name:</label><br>
        <input class="uk-input border-charcoal2 uk-width-1-1" type="text">
      </div>

      <div class="uk-modal-footer fog uk-text-left">
        <button class="uk-button button-lt uk-modal-close" type="button">Add</button>
      </div>
    </div>
  </div>

  <div class="uk-margin-large"></div>

  <!--------------------------->
  <!-- User Setup Section -->
  <!--------------------------->
  <div class="uk-card uk-card-default uk-margin-medium-top uk-margin-right uk-margin-left">
    <div class="uk-card-header container-top">
      <div class="uk-grid-small uk-flex-middle" uk-grid>
        <h4 class="norwester font-white">Users <h5 class="font-white" id="user_count">({{ users.length }})</h5></h4>
      </div>
    </div>
    <div class="charcoal uk-padding-small">
      <form class="uk-width-1-1">
        <div class="uk-form-controls uk-inline uk-width-1-3@m uk-margin-right">
          <span class="uk-form-icon" uk-icon="icon: search"></span>
          <input class="uk-input border-charcoal2" type="text" placeholder="Search by user name">
        </div>
        <div class="uk-inline uk-width-1-3@m uk-margin-right">
          <select class="uk-select border-charcoal2">
            <option>Sort Alphabetically (A-Z)</option>
            <option>Sort Alphabetically (Z-A)</option>
          </select>
        </div>
        <div class="uk-inline uk-float-right">
          <h5 class="font-white"><a href="#" class="font-white">Clear Filters</a> &nbsp;|&nbsp; <a href="#" class="font-white">Export</a></h5>
        </div>
      </form>
    </div>

    <div class="uk-card-body white uk-padding-remove uk-margin-remove uk-overflow-auto">
      <div class="uk-grid uk-padding-remove uk-child-width-1-3" uk-grid>
        <div>
          <table class="uk-table uk-table-small alumni-table uk-margin-remove">
            <tbody>
              <tr v-bind:class="{ 'selected': user.id == selectedUser.id }" v-for="user in displayUsers" v-on:click="setSelectedUser(user)"><td>{{ user.name }}<span uk-icon="icon: chevron-right; ratio: 1.5" class="font-white uk-float-right" :key="user.id"></td></tr>
            </tbody>
          </table>
          <div class="uk-padding-small black">
            <ul class="uk-pagination uk-flex-center uk-margin-remove">
              <li><a v-on:click="paginateLeft"><span uk-icon="icon: chevron-left; ratio: 2" class="font-white"></span></a></li>
              <li>
                <div>
                  <select class="uk-select border-charcoal2" v-model="pageNumber">
                    <option v-for="page in Array(pageCount).keys()">{{ page + 1}}</option>
                  </select>
                </div>
              </li>
              <li class="font-white uk-margin-small">of {{ pageCount }}</li>
              <li><a v-on:click="paginateRight"><span uk-icon="icon: chevron-right; ratio: 2" class="font-white"></span></a></li>
            </ul>
          </div>
        </div>

        <div class="uk-padding">
          <h3 class="tight norwester">{{ selectedUser.name }}</h3>
          <h6 class="tight">Member since <span id="member_date">{{ moment(selectedUser.createdAt).format('MM-DD-YYYY') }}</span></h6>
          <hr></hr>
          <h4 class="norwester">Permissions <a>(+ Add)</a></h4>
          <div uk-alert class="border-slate uk-border-rounded">
            <button class="uk-alert-close uk-close-large" type="button" uk-close></button>
              <p>Group Leader</p>
          </div>
          <div uk-alert class="border-slate uk-border-rounded">
            <button class="uk-alert-close uk-close-large" type="button" uk-close></button>
            <p>Paid Member</p>
          </div>
        </div>

        <div class="uk-padding uk-padding-remove-bottom">
          <h4 class="norwester">History</h4>
          <div class="uk-divider-vertical uk-padding-small uk-padding-remove-top uk-float-left uk-width-1-1" v-for="event in selectedUser.activityHistoryItems">
            <h6 class="wide font-black">
              <span id="change_descr"><strong>{{ event.activityDescription }}</strong></span><br>
              <span id="chg_date">{{ moment(event.createdAt).format('MM-DD-YYYY') }}</span>, <span id="chg_time">{{ moment(event.createdAt).format('hh:mm A') }}</span>
            </h6>
          </div>
        </div>

        <a class="uk-button button-lt font-small float-right" href="#history-modal" uk-toggle>View All</a>

        <!-- Here is the code for the modal with additional history -->
        <div id="history-modal" uk-modal>
          <div class="uk-modal-dialog">
            <button class="uk-modal-close-default" type="button" uk-close></button>
            <div class="uk-modal-header fog">
              <h2 class="uk-modal-title">User History</h2>
            </div>

            <div class="uk-modal-body" uk-overflow-auto>
              <div class="uk-divider-vertical uk-padding-small uk-padding-remove-top uk-float-left uk-width-1-1" v-for="event in selectedUser.activityHistoryItems">
                <h5>
                  <span id="change_descr"><strong>{{ event.activityDescription }}</strong></span><br>
                  <span id="chg_date">{{ moment(event.createdAt).format('MM-DD-YYYY') }}</span>, <span id="chg_time">{{ moment(event.createdAt).format('hh:mm A') }}</span>
                </h5>
              </div>

              <div class="uk-modal-footer fog uk-text-left">
                <button class="uk-button button-lt uk-modal-close" type="button">Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="uk-margin-large"></div>
  <%- include('footer'); %>
</div>
  <script type="text/javascript">
    var app = new Vue({
      el: '#app',
      data: {
        pageNumber: 1,
        pageSize: 10,
        users: <%- JSON.stringify(userList) %>,
        filteredUsers: <%- JSON.stringify(userList) %>,
        selectedUser: <%- JSON.stringify(userList[0]) || {} %>
      },
      computed: {
        displayUsers: function() {
          var startEl = (this.pageNumber - 1) * this.pageSize;
          return this.filteredUsers.slice(startEl, startEl + this.pageSize);
        },
        pageCount: function() {
          return Math.ceil(this.filteredUsers.length / this.pageSize);
        }
      },
      methods: {
        paginateLeft: function() {
          if (this.pageNumber > 1) this.pageNumber--;
        },
        paginateRight: function() {
          if (this.pageNumber < this.pageCount) this.pageNumber++;
        },
        setSelectedUser: function(user) {
          this.selectedUser = user;
        }
      }
    });
  </script>
</body>
</html>
